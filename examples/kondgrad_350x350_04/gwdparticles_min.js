(function(){'use strict';var l,q=function(a,b,d){a=parseInt(a.getAttribute(b),10);isNaN(a)&&(a=d);return a},v=function(a,b,d){a=q(a,b,d);return 0<a?a:d},w=function(a,b,d){a=parseFloat(a.getAttribute(b));isFinite(a)||(a=d);return a},x=function(a,b,d){return a.hasAttribute(b)?a.getAttribute(b):d},y=function(a,b,d){switch(a.getAttribute(b)){case "true":return!0;case "false":return!1;default:return d}};var z=function(a){return"gwd-page"==a.tagName.toLowerCase()||"gwd-page"==a.getAttribute("is")},A=function(a){if(z(a))return a;for(;a&&9!=a.nodeType;)if((a=a.parentElement)&&z(a))return a;return null};var B={o:0,s:0,u:0,v:0,w:"#fff",A:"#fff",B:0,l:0,g:0,C:"0px",D:"0px",F:"0px",G:"0px",loop:!1,H:0,I:1,J:1,K:0,M:!1,shape:"square",O:1,P:1,R:0,S:0,i:0,j:0,$:"",N:!1,m:1,T:0,f:1,U:1},D={o:0,s:0,u:280,v:260,w:"#fff",A:"#fff",B:0,l:.005,g:2,C:"100%",D:"0%",F:"10%",G:"0%",loop:!0,H:0,I:1,J:.1,K:0,M:!0,shape:"circle",O:12,P:8,R:0,S:0,i:2,j:1,$:"",N:!1,m:1,T:0,f:1,U:1},aa={o:0,s:.6,u:271,v:269,w:"#fff",A:"#fff",B:0,l:.01,g:2,C:"100%",D:"0%",F:"10%",G:"0%",loop:!0,H:0,I:1,J:.5,K:0,M:!0,shape:"line",O:25,P:10,
R:0,S:100,i:10,j:8,$:"",N:!1,m:1,T:0,f:1,U:1},ba={o:0,s:.6,u:100,v:80,w:"#ffdc00",A:"#dc000a",B:1.2,l:0,g:1,C:"20px",D:"10px",F:"40px",G:"35px",loop:!0,H:10,I:.3,J:.1,K:-.3,M:!1,shape:"teardrop",O:20,P:20,R:-30,S:100,i:1,j:.5,$:"",N:!0,m:20,T:.18,f:1,U:30},ca={o:0,s:.6,u:100,v:80,w:"#ffdc00",A:"#dc000a",B:1,l:0,g:2,C:"50px",D:"20px",F:"100px",G:"95px",loop:!0,H:15,I:.3,J:.1,K:-.3,M:!1,shape:"teardrop",O:40,P:40,R:-30,S:100,i:2,j:1,$:"",N:!0,m:20,T:.18,f:1,U:30},da={o:0,s:.6,u:100,v:80,w:"#ffdc00",
A:"#dc000a",B:.8,l:0,g:4,C:"80px",D:"30px",F:"180px",G:"175px",loop:!0,H:15,I:.3,J:.1,K:-.3,M:!1,shape:"teardrop",O:100,P:100,R:-54,S:100,i:3,j:2,$:"",N:!0,m:20,T:.18,f:1,U:25},ea={o:0,s:0,u:90,v:90,w:"#dcdcdc",A:"#dcdcdc",B:0,l:0,g:25,C:"22px",D:"10px",F:"120px",G:"100px",loop:!0,H:8,I:.03,J:.03,K:-.018,M:!0,shape:"teardrop",O:15,P:15,R:-.06,S:100,i:1,j:.8,$:"",N:!0,m:60,T:.6,f:.5,U:40},fa={o:0,s:.06,u:100,v:80,w:"#dcdcdc",A:"#dcdcdc",B:0,l:0,g:2,C:"35px",D:"10px",F:"150px",G:"148px",loop:!0,H:300,
I:.1,J:.1,K:-.03,M:!0,shape:"circle",O:20,P:10,R:-1.2,S:100,i:.8,j:.8,$:"",N:!0,m:10,T:0,f:.5,U:1};var ha=/[^\d]+$/,F=function(a,b,d,c){if(!a.hasAttribute(b))return d;a=a.getAttribute(b);return isNaN(parseFloat(a))?d:E(a,c)},E=function(a,b){var d=parseFloat(a);(a=(a=a.match(ha))&&a[0]||null)&&(a=a.trim());var c=d;"%"==a&&(c=Number((d/100*b).toFixed(2)));return c};var ia=/^#(?:[0-9a-f]{3}){1,2}$/i,ja=/#(.)(.)(.)/,G=[60,6E3],H=function(a){if(!ia.test(a))return null;4==a.length&&(a=a.replace(ja,"#$1$1$2$2$3$3"));a=a.toLowerCase();a=parseInt(a.substr(1),16);return[a>>16,a>>8&255,a&255]},K=function(a,b,d,c,e){b=w(a,b,c);a=w(a,d,e);b>a&&(d=b,b=a,a=d);return[b,a]},ka=function(a){switch(a){case "snow":return D;case "rain":return aa;case "fire-small":return ba;case "fire-medium":return ca;case "fire-large":return da;case "steam":return ea;case "smoke":return fa;default:return B}},
L=function(a,b,d,c,e,f){b=F(a,b,c,f);a=F(a,d,e,f);b>a&&(d=b,b=a,a=d);return[b,a]};var la=2*Math.PI,M=function(a,b){return a+Math.random()*(b-a)},O=function(a,b){this.h=[];this.b=b;this.Ta=a.width;this.Sa=a.height;this.c=a.getContext("2d");this.wa=window.devicePixelRatio;this.Ba=1;this.Fa=[];this.Ga=[];if("image"!=this.b.oa.shape)a=null;else if((a=this.b.oa.Va)&&0!=a.length){b=[];this.Ba=this.b.na.max*this.wa;for(var d=0;d<a.length;d++){var c=a[d],e=document.createElement("canvas"),f=e.getContext("2d"),g=this.Ba/Math.max(c.naturalWidth,c.naturalHeight),k=c.naturalWidth*g;g*=c.naturalHeight;
e.width=Math.ceil(k);e.height=Math.ceil(g);f.drawImage(c,0,0,k,g);b.push(e);this.Fa.push(-k/2);this.Ga.push(-g/2)}a=b}else this.b.oa.shape="square",a=null;this.xa=a;this.la=0;this.Ra=0==this.b.g?this.b.za:1/this.b.g;a=this.b.ba;this.va=a.ga?0:(a.ja-a.sa)*a.Aa;this.ua=a.ga?0:(a.ia-a.ra)*a.Aa;this.ta=a.ga?0:(a.ha-a.qa)*a.Aa;this.Ca=(a=this.b.Ja)?new ma:null;this.Da=a?a.frequency:1;this.$a=a?a.Ya:1;this.Ka=a&&a.Za-1||0;for(a=0;a<this.b.Ia;a++)N(this)};
O.prototype.reset=function(){for(var a=this.la=this.h.length=0;a<this.b.Ia;a++)N(this)};
var Q=function(a){var b=M(a.b.ma.Ma,a.b.ma.La),d=M(a.b.ma.Oa,a.b.ma.Na),c=M(a.b.na.min,a.b.na.max),e=M(a.b.ya.min,a.b.ya.max),f=a.b.ba,g=f.sa,k=f.ra,h=f.qa;f.ga&&(h=Math.random(),g=(1-h)*f.sa+h*f.ja,k=(1-h)*f.ra+h*f.ia,h=(1-h)*f.qa+h*f.ha);var t=M(a.b.pa.j,a.b.pa.i);f=M(a.b.pa.Qa,a.b.pa.Pa);var u=t*Math.cos(f);t*=Math.sin(f);var m=-1;a.xa&&(m=Math.floor(M(0,a.xa.length)));return{a:{positionX:b,positionY:d,size:c,X:g,W:k,V:h,opacity:e,da:!0,angle:f,ea:m},velocityX:u,velocityY:t,f:a.$a,aa:a.Ka?new P(a.Ka):
null}},N=function(a){for(var b=Date.now()/a.Da,d=0;d<a.h.length;d++){var c=a.h[d],e=a;c.aa&&c.aa.push({positionX:c.a.positionX,positionY:c.a.positionY,size:c.a.size,X:c.a.X,W:c.a.W,V:c.a.V,opacity:c.a.opacity,angle:c.a.angle,ea:c.a.ea,da:c.a.da});if(c.a.da){c.a.positionX+=c.velocityX;c.a.positionY+=c.velocityY;if(e.Ca&&0<c.f){var f=c.a.positionX/e.Da,g=c.a.positionY/e.Da;c.a.positionX+=c.f*R(e.Ca,f,g,b);c.a.positionY+=c.f*R(e.Ca,b,f,g);c.f+=e.b.Ja.rate}c.a.size+=e.b.na.rate;c.a.opacity=Math.min(1,
c.a.opacity+e.b.ya.rate);c.velocityX+=e.b.acceleration.x;c.velocityY+=e.b.acceleration.y;c.a.angle=Math.atan2(c.velocityY,c.velocityX);f=e.b.ba;f.ga||((!e.va||1<(f.ja-c.a.X)/e.va)&&(!e.ua||1<(f.ia-c.a.W)/e.ua)&&(!e.ta||1<(f.ha-c.a.V)/e.ta)?(c.a.X+=e.va,c.a.W+=e.ua,c.a.V+=e.ta):(c.a.X=e.b.ba.ja,c.a.W=e.b.ba.ia,c.a.V=e.b.ba.ha))}if(0>c.a.positionX+c.a.size||c.a.positionX-c.a.size>a.Ta||0>c.a.positionY+c.a.size||c.a.positionY-c.a.size>a.Sa||0>c.a.opacity||0>c.a.size)a.b.Xa?(c=c.aa,a.h[d]=Q(a),a.h[d].aa=
c):c.a.da=!1}if(a.h.length<a.b.za)for(a.la=Math.min(a.la+a.Ra,a.b.za),b=Math.floor(a.la)-a.h.length,d=0;d<b;d++)a.h.push(Q(a))},S=function(a,b){if(b.da){a.c.fillStyle="rgba("+Math.round(b.X)+", "+Math.round(b.W)+", "+Math.round(b.V)+", "+b.opacity+")";a.c.save();a.c.translate(b.positionX,b.positionY);var d=b.size/a.Ba;a.c.scale(d,d);switch(a.b.oa.shape){case "circle":a.c.beginPath();a.c.arc(0,0,.5,0,la);a.c.fill();break;case "line":a.c.beginPath();a.c.rotate(b.angle);a.c.fillRect(-.5,-.01,1,.02);
break;case "teardrop":a.c.beginPath();a.c.moveTo(.08,-.5);a.c.bezierCurveTo(.13,-.21,.16,.04,.3,.07);a.c.bezierCurveTo(.44,.36,.13,.5,-.06,.5);a.c.bezierCurveTo(-.49,.14,-.41,0,.08,-.5);a.c.fill();break;case "image":a.c.globalAlpha=b.opacity;a.c.drawImage(a.xa[b.ea],a.Fa[b.ea],a.Ga[b.ea]);break;default:a.c.beginPath(),a.c.fillRect(-.5,-.5,1,1)}a.c.restore()}};var T=function(a,b,d){return a+d*(b-a)},U=function(a){return a*a*a*(a*(6*a-15)+10)},V=function(a,b,d,c){switch(a%16){case 0:return b+d;case 1:return-b+d;case 2:return b-d;case 3:return-b-d;case 4:return b+c;case 5:return-b+c;case 6:return b-c;case 7:return-b-c;case 8:return d+c;case 9:return-d+c;case 10:return d-c;case 11:return-d-c;case 12:return b+d;case 13:return-d+c;case 14:return-b+d;case 15:return-d-c;default:return 0}},ma=function(){for(var a=Array(256),b=0;b<a.length;++b)a[b]=b;for(b=a.length-
1;0<b;--b){var d=Math.floor(Math.random()*a.length),c=a[b];a[b]=a[d];a[d]=c}this.Wa=a.concat(a)},R=function(a,b,d,c){var e=b&255,f=d&255,g=c&255;b-=Math.floor(b);d-=Math.floor(d);c-=Math.floor(c);var k=U(b),h=U(d);a=a.Wa;return T(T(T(V(a[a[a[e]+f]+g],b,d,c),V(a[a[a[e+1]+f]+g],b-1,d,c),k),T(V(a[a[a[e]+f+1]+g],b,d-1,c),V(a[a[a[e+1]+f+1]+g],b-1,d-1,c),k),h),T(T(V(a[a[a[e]+f]+g+1],b,d,c-1),V(a[a[a[e+1]+f]+g+1],b-1,d,c-1),k),T(V(a[a[a[e]+f+1]+g+1],b,d-1,c-1),V(a[a[a[e+1]+f+1]+g+1],b-1,d-1,c-1),k),h),U(c))};var P=function(a){this.Ha=a;this.Ea=[];this.length=this.ka=0};P.prototype.get=function(a){return this.Ea[(a+this.ka)%this.length]};P.prototype.push=function(a){this.length<this.Ha&&this.length++;this.Ea[this.ka]=a;this.ka=(this.ka+1)%this.Ha};var W=function(a,b){var d=document.createEvent("Event");d.initEvent(a,!0,!0);b.dispatchEvent(d)};var X=function(){};goog.inherits(X,HTMLElement);l=X.prototype;l.createdCallback=function(){this.L=null;this.Z=0;this.Y=[];this.ca=this.Ua.bind(this);this.fa=2};l.attributeChangedCallback=function(){this.reset()};l.attachedCallback=function(){if("function"==typeof this.gwdLoad&&"function"==typeof this.gwdIsLoaded&&!this.gwdIsLoaded()){var a=A(this),b=a&&"function"==typeof a.gwdIsLoaded;(!a||b&&a.gwdIsLoaded())&&this.gwdLoad()}};l.detachedCallback=function(){Y(this);this.L=null};
l.gwdLoad=function(){if(!this.L){Y(this);var a=[],b=x(this,"sprite-image-src","");if(b){b=b.split(",");for(var d=0;d<b.length;d++)a[d]=b[d].trim()}if(this.Z=a.length)for(b=0;b<this.Z;b++)d=this.ownerDocument.createElement("img"),d.addEventListener("load",this.ca,!1),d.addEventListener("error",this.ca,!1),d.src=a[b],this.Y.push(d);0==this.Z&&Z(this)}};l.gwdIsLoaded=function(){return!!this.L};
var Y=function(a){for(;a.Y.length;){var b=a.Y.pop();b.removeEventListener("load",a.ca,!1);b.removeEventListener("error",a.ca,!1)}a.Z=0},Z=function(a){var b=a.getAttribute("preset-type"),d=a.Y.length?a.Y:null;if(a.parentElement){var c=a.parentElement.getElementsByTagName("canvas")[0];if(c){b=ka(b);var e=c.width,f=c.height,g=E(b.D,e),k=E(b.C,e),h=E(b.G,f),t=E(b.F,f);e=L(a,"emit-x-min","emit-x-max",g,k,e);f=L(a,"emit-y-min","emit-y-max",h,t,f);f={Ma:e[0],La:e[1],Oa:f[0],Na:f[1]};h=b.H;b.l&&(h=Math.ceil(b.l*
(f.La-f.Ma)*(f.Na-f.Oa)));h=Math.min(v(a,"number",h),1E3);t=v(a,"emit-interval",b.g);e=b.S;g=q(a,"skip-forward",e);e=Math.round((0<=g?g:e)*Math.min(Math.max(h*t,G[0]),G[1])/100);g=y(a,"loop",b.loop);k=K(a,"size-min","size-max",b.P,b.O);var u=w(a,"size-rate",b.R)/60;k={min:k[0],max:k[1],rate:u};u=K(a,"opacity-min","opacity-max",b.J,b.I);var m=w(a,"opacity-rate",b.K)/60;u={min:u[0],max:u[1],rate:m};m=x(a,"color1",b.w);var r=x(a,"color2",b.A);m=H(m);r=H(r);var n=y(a,"random-colors",b.M),p=w(a,"color-rate",
b.B)/60;m={ga:n,sa:m[0],ra:m[1],qa:m[2],ja:r[0],ia:r[1],ha:r[2],Aa:p};r=K(a,"speed-min","speed-max",b.j,b.i);n=K(a,"angle-min","angle-max",b.v,b.u);n[0]=-n[0];n[1]=-n[1];r={j:r[0],i:r[1],Qa:n[1]/180*Math.PI,Pa:n[0]/180*Math.PI};n=w(a,"acceleration-x",b.o)/60;p=w(a,"acceleration-y",b.s)/60;n={x:n,y:p};p=x(a,"shape",b.shape);d={shape:p,Va:"image"==p?d:null};p=a.hasAttribute("turbulence-frequency");var C=a.hasAttribute("turbulence-strength"),I=a.hasAttribute("turbulence-rate"),J=a.hasAttribute("turbulence-trail");
b.N||p||C||I||J?(p=w(a,"turbulence-frequency",b.m),C=w(a,"turbulence-strength",b.f),I=w(a,"turbulence-rate",b.T)/60,J=Math.min(v(a,"turbulence-trail",b.U),100),b={frequency:0<p?p:b.m,Ya:0<C?C:b.f,rate:I,Za:J}):b=null;a.L=new O(c,{za:h,g:t,Ia:e,ma:f,na:k,ya:u,ba:m,pa:r,acceleration:n,Xa:g,oa:d,Ja:b});W("ready",a)}}};l=X.prototype;
l.Ua=function(a){var b=a.target;b.removeEventListener("load",this.ca,!1);b.removeEventListener("error",this.ca,!1);b=this.Y.indexOf(b);0<=b&&("error"==a.type&&this.Y.splice(b,1),this.Z--);0==this.Z&&Z(this)};l.updateAndDraw=function(){0==this.fa&&N(this.L);if(2!=this.fa){var a=this.L;a.c.save();a.c.scale(a.wa,a.wa);for(var b=0;b<a.h.length;b++){var d=a.h[b];if(d.aa)for(var c=0;c<d.aa.length;c++)S(a,d.aa.get(c));S(a,d.a)}a.c.restore()}};l.play=function(){this.fa=0};l.pause=function(){this.fa=1};
l.stop=function(){this.fa=2;this.L.reset()};l.reset=function(){Y(this);this.L=null;W("request-reload",this)};document.registerElement("gwd-particles",{prototype:X.prototype});}).call(this);
